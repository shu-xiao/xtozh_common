#include <string>
#include <map>
#include <iostream>
#include <fstream>
#include <TGraph.h>
#include <TAxis.h>
#include <TCanvas.h>
#include <TFrame.h>
#include <TH1.h>
#include <TLegend.h>

using namespace std;
std::string par[]={"M", 
		   "TW", 
		   "BRZZ", 
		   "BRWW",
		   "BRhh",
		   "BRAA",
		   "BRgg"
		   "BRtt"
};

const int nPars= sizeof(par)/sizeof(par[0]);


double BRnumbers[][nPars]={
  //{200, 0.0751457, 0.316483, 0.677924, 0., 0.00497088, 0.},
{300, 0.0843048, 0.355847, 0.627744, 0.00893246, 0.00664625, 0.},
{400, 0.0999584, 0.308107, 0.562192, 0.0564194, 0.00747392, 0.0648727},
{500, 0.144051, 0.230339, 0.43172, 0.0822399, 0.00648277, 0.248408},
{600, 0.197935, 0.184219, 0.351392, 0.0915306, 0.00566156, 0.366489},
{700, 0.254155, 0.158352, 0.30557, 0.0952416, 0.00514408, 0.435049},
{800, 0.310412, 0.142802, 0.277753, 0.0969524, 0.00481349, 0.477078},
{900, 0.366036, 0.132777, 0.259704, 0.0978388, 0.00459226, 0.504514},
{1000, 0.420889, 0.125936, 0.247333, 0.0983415, 0.00443752, 0.523397},
{1100, 0.475008, 0.121055, 0.238477, 0.0986477, 0.00432514, 0.536955},
{1200, 0.528477, 0.117445, 0.231912, 0.0988449, 0.00424095, 0.547027},
{1300, 0.581389, 0.114697, 0.226905, 0.0989781, 0.00417623, 0.554722},
{1400, 0.633826, 0.112554, 0.222997, 0.0990714, 0.00412539, 0.560737},
{1500, 0.685862, 0.110851, 0.219884, 0.0991391, 0.00408472, 0.565531},
{1600, 0.737556, 0.109472, 0.217364, 0.0991894, 0.00405166, 0.569416},
{1700, 0.788958, 0.108341, 0.215295, 0.0992278, 0.00402441, 0.572609},
{1800, 0.840111, 0.107401, 0.213573, 0.0992576, 0.00400169, 0.575266},
{1900, 0.891047, 0.106611, 0.212126, 0.0992812, 0.00398254, 0.577502},
{2000, 0.941797, 0.10594, 0.210896, 0.0993003, 0.00396625, 0.579401},
{2100, 0.992384, 0.105366, 0.209843, 0.0993158, 0.00395227, 0.581029},
{2200, 1.04283, 0.104871, 0.208934, 0.0993286, 0.00394019, 0.582434},
{2300, 1.09315, 0.10444, 0.208144, 0.0993393, 0.00392967, 0.583656},
{2400, 1.14336, 0.104063, 0.207453, 0.0993484, 0.00392046, 0.584725},
{2500, 1.19347, 0.103732, 0.206844, 0.0993561, 0.00391235, 0.585666},
{2600, 1.24349, 0.103439, 0.206306, 0.0993627, 0.00390516, 0.586499},
{2700, 1.29343, 0.103178, 0.205828, 0.0993684, 0.00389877, 0.58724},
{2800, 1.3433, 0.102945, 0.2054, 0.0993733, 0.00389306, 0.587901},
{2900, 1.39311, 0.102737, 0.205017, 0.0993777, 0.00388794, 0.588495},
{3000, 1.44287, 0.102549, 0.204672, 0.0993816, 0.00388332, 0.589029}//,

// {3100, 1.49256, 0.102379, 0.20436, 0.099385, 0.00387915, 0.589512},
// {3200, 1.54222, 0.102225, 0.204078, 0.099388, 0.00387536, 0.589949},
// {3300, 1.59183, 0.102086, 0.203821, 0.0993907, 0.00387192, 0.590347},
// {3400, 1.64139, 0.101958, 0.203586, 0.0993931, 0.00386878, 0.59071},
// {3500, 1.69093, 0.101841, 0.203372, 0.0993953, 0.0038659, 0.591042},
// {3600, 1.74043, 0.101734, 0.203175, 0.0993973, 0.00386327, 0.591347},
// {3700, 1.78989, 0.101636, 0.202994, 0.0993991, 0.00386084, 0.591627},
// {3800, 1.83933, 0.101546, 0.202828, 0.0994008, 0.00385861, 0.591885},
// {3900, 1.88875, 0.101462, 0.202674, 0.0994023, 0.00385654, 0.592123},
// {4000, 1.93814, 0.101384, 0.202532, 0.0994036, 0.00385463, 0.592344}
};


double RSnumbers[][nPars]={
  //{260, 2.5103803719127504, 0.07521664199467669, 0.14911685998599558, 7.875333606243001e-6, 0.48359465555005504, 0.},
{300, 2.8859480356974023, 0.07469394443823439, 0.14649859492719147, 0.0002609363907507743, 0.485378374629645, 0.},
{350, 3.351550290574848, 0.07328949992668986, 0.1437147412964559, 0.0008527793007645482, 0.4876070533389467, 0.},
{400, 3.8238561586466635, 0.07193042517675718, 0.14141497086275018, 0.0014748453016228675, 0.48843426067511353, 0.0016958197516185154},
{450, 4.303635075739956, 0.07077381148970963, 0.13951721074317788, 0.00202120813640487, 0.4882303246604532, 0.004521306362332376},
{500, 4.787687628560061, 0.06984156281777043, 0.1379969371883721, 0.0024744221679741125, 0.48763163469435944, 0.007474071851055721},
{550, 5.274154324512369, 0.06909820314141359, 0.1367839792633552, 0.002843812476091045, 0.486919908137161, 0.010197588588935975},
{600, 5.76195246642807, 0.0685035928156648, 0.13581134091364372, 0.003144265384982541, 0.48621600924132113, 0.012589650142468338},
{650, 6.250456380380763, 0.06802401729992531, 0.13502464160815508, 0.0033897489806557304, 0.485567155970142, 0.014648274888560615},
{700, 6.739303367402993, 0.06763333850344727, 0.13438202742595384, 0.0035917787224510177, 0.48498768261689057, 0.016406705221436405},
{750, 7.22828263841203, 0.06731178975609917, 0.1338518305599718, 0.003759423688146881, 0.4844777234458545, 0.017906928311718383},
{800, 7.71727219289653, 0.06704449099329272, 0.13341014055879907, 0.0038997130095539006, 0.48403174310625335, 0.01918947150801794},
{850, 8.20620257972335, 0.0668201957669316, 0.13303881940036108, 0.004018077826392619, 0.48364239944939263, 0.020289984965438462},
{900, 8.695035768212453, 0.0666303374283415, 0.13272400014490748, 0.004118727164348574, 0.48330224423690793, 0.02123858223063925},
{950, 9.183752629051764, 0.06646832905457276, 0.1324549837687051, 0.004204942476367313, 0.48300441814353806, 0.022060227290352116},
{1000, 9.672345405903425, 0.0663290555435926, 0.13222343593938748, 0.00427930100894505, 0.4827428812241931, 0.02277544817060354},
{1050, 10.160813131088863, 0.06620850532424291, 0.1320228020689365, 0.004343843097937954, 0.4825124348476319, 0.02340108468364833},
{1100, 10.649158807083124, 0.06610350201413001, 0.131847879251286, 0.004400197131035117, 0.4823086566207741, 0.02395096218867509},
{1150, 11.137387663091957, 0.06601150743853024, 0.13169450073415945, 0.004449673107888205, 0.48212780548638084, 0.024436461324495094},
{1200, 11.6255060747466, 0.06593047576935084, 0.13155930138280894, 0.0044933330427632395, 0.4819667231090255, 0.024866985158437018},
{1250, 12.113520897258674, 0.0658587445193335, 0.13143954179464737, 0.00453204428524029, 0.48182274264475744, 0.025250336352231766},
{1300, 12.6014390585394, 0.06579495231948349, 0.1313329752116509, 0.004566520194709918, 0.48169360880735723, 0.025593019470973373},
{1350, 13.089267316695198, 0.06573797633006855, 0.1312377459239276, 0.004597351400961763, 0.4815774098146707, 0.025900482664989358},
{1400, 13.57701212171132, 0.06568688417340611, 0.13115231104515232, 0.004625030011213332, 0.4814725203614251, 0.02617731092491159},
{1450, 14.0646795430726, 0.06564089670386836, 0.13107537978395736, 0.00464996849485267, 0.4813775542454314, 0.026427380914201413},
{1500, 14.552275238833898, 0.06559935893649155, 0.13100586592393285, 0.004672514523079795, 0.4812913251854729, 0.026653985393263087},
{1600, 15.527272012722566, 0.0655275008512724, 0.1308855513359164, 0.004711563976558388, 0.48114114423865956, 0.027047632404795307},
{1700, 16.502039618125195, 0.06546779406643832, 0.1307855246309112, 0.004744054452606252, 0.48101538935416777, 0.027376282942389335},
{1800, 17.47660943705463, 0.06541765327855358, 0.13070148335818887, 0.004771370476951255, 0.48090910489620614, 0.0276533753468986},
{1900, 18.451007876278858, 0.06537514401426231, 0.13063020428833838, 0.004794551130948838, 0.48081851405766485, 0.027889076051787923},
{2000, 19.42525716454694, 0.06533879600711626, 0.1305692351528377, 0.004814388129080045, 0.48074070267273183, 0.028091182511043485},
{2100, 20.399376058185858, 0.065307475982627, 0.13051668410658404, 0.004831493012649385, 0.4806733960812606, 0.028265750966327937},
{2200, 21.37338043884431, 0.0652802992394397, 0.13047107315571643, 0.0048463440492338165, 0.48061479961784354, 0.02841753991234471},
{2300, 22.34728380910965, 0.06525656710273953, 0.13043123432702783, 0.004859319527689692, 0.48056348312618946, 0.028550328080503732},
{2400, 23.321097699192325, 0.06523572196385899, 0.13039623493988917, 0.004870721764886823, 0.48051829631705023, 0.028667145645996987},
{2500, 24.294831999185142, 0.06521731448413957, 0.13036532303803014, 0.004880794663519596, 0.4804783060033112, 0.028770444535058535},
{2600, 25.268495230287684, 0.06520097934828052, 0.13033788700875143, 0.004889736722600593, 0.4804427490401628, 0.028862225397891718},
{2700, 26.242094766486453, 0.06518641711549794, 0.13031342533263554, 0.004897710795452612, 0.4804109966705887, 0.028944133344373495},
{2800, 27.21563701620269, 0.0651733804791516, 0.1302915236645422, 0.004904851490447566, 0.48038252724536445, 0.02901753088803325},
{2900, 28.18912757163293, 0.06516166375365388, 0.13027183728634906, 0.004911270842320965, 0.48035690515680957, 0.02908355407066519},
{3000, 29.162571331994897, 0.06515109475152146, 0.13025407754119125, 0.004917062700192497, 0.480333764428927, 0.029143156042338466}
};




const int nBRMasses= sizeof(BRnumbers)/sizeof(BRnumbers[0]);


const int nRSMasses= sizeof(RSnumbers)/sizeof(RSnumbers[0]);

void readBR(double searchM)
{

  typedef map<string, double> parMap;
  typedef map<double, parMap> massMaps;

  massMaps BulkMap;
  for(int i=0; i < nBRMasses; i++){
    parMap thisMass;
    for(int j=0; j < nPars; j++){
      thisMass.insert(std::pair<string, double>(par[j],BRnumbers[i][j]));
    }

    BulkMap.insert(std::pair<double, parMap>(BRnumbers[i][0],thisMass));
  }

  massMaps RSMap;
  for(int i=0; i < nRSMasses; i++){
    parMap thisMass;
    for(int j=0; j < nPars; j++){
      thisMass.insert(std::pair<string, double>(par[j],RSnumbers[i][j]));
    }

    RSMap.insert(std::pair<double, parMap>(RSnumbers[i][0],thisMass));
  }

  ofstream fout;
  double BR1=BulkMap[searchM]["BRhh"];
  double BR2=RSMap[searchM]["BRhh"];
  cout << "---------------------------------------------------------------------------------------------------------------------------" << endl;
  cout << "BR(Bulk G->hh)  = " << BR1 << endl;
  cout << "RS(Bulk G->hh)  = " << BR2 << endl;


  float BRhh_bulk[nBRMasses];
  float mass_bulk[nBRMasses];

  for(int i=0; i< nBRMasses; i++){
    double M = BRnumbers[i][0];
    mass_bulk[i]= M;
    BRhh_bulk[i]= BulkMap[M]["BRhh"];

  }


  float BRhh_RS[nRSMasses];
  float mass_RS[nRSMasses];

  for(int i=0; i< nRSMasses; i++){
    double M = RSnumbers[i][0];
    mass_RS[i]= M;
    BRhh_RS[i]= RSMap[M]["BRhh"];

  }

  TGraph* gr = new TGraph(nBRMasses, mass_bulk,BRhh_bulk);
  gr->GetXaxis()->SetTitle("Mass of gravitons [GeV]");
  gr->GetYaxis()->SetTitle("BR(G#rightarrow hh)");
  gr->SetLineColor(4);
  gr->Draw("AC*");

  TGraph* gr2 = new TGraph(nRSMasses, mass_RS,BRhh_RS);
  gr2->GetXaxis()->SetTitle("Mass of gravitons [GeV]");
  gr2->GetYaxis()->SetTitle("BR(G#rightarrow hh)");
  gr2->SetLineColor(2);
  gr2->Draw("AC*same");


  TCanvas* c1 = new TCanvas("c1","",200,10,500,500);
  TPad *pad = new TPad("pad","",0,0,1,1);
  pad->SetFillColor(0);
  pad->SetFillStyle(0);
  pad->SetGrid();
  pad->Draw();
  pad->cd();

  TH1F *hr = pad->DrawFrame(200,0,3200,0.12);
  hr->SetXTitle("Mass of graviton [GeV]");
  hr->SetYTitle("BR(G#rightarrow hh)");
  hr->GetYaxis()->SetDecimals();
  hr->GetYaxis()->SetTitleOffset(1.4);
  pad->GetFrame()->SetFillColor(0);
  pad->GetFrame()->SetBorderSize(12);

  gr->SetMarkerStyle(21);
  gr->SetMarkerColor(4);
  gr->Draw("LP");


  gr2->SetMarkerStyle(8);
  gr2->SetMarkerColor(2);
  gr2->Draw("LPsame");

  TLegend* legend = new TLegend(0.431452, 0.446099, 0.830645,0.625793,
				NULL,"brNDC");
  legend->SetLineColor(1);
  legend->SetLineStyle(1);
  legend->SetLineWidth(1);
  legend->SetBorderSize(0);
  legend->SetFillStyle(0);
  legend->SetTextSize(0.05);
  legend->AddEntry(gr,"G_{bulk}#rightarrow hh","lp");
  legend->AddEntry(gr2,"G_{RS}#rightarrow hh","lp");
  legend->Draw("same");

}
